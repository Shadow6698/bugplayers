-- Bug Player GUI System (TextBox Version)
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer

-- Vari√°veis do sistema
local textBoxes = {}
local bugPlayerActive = false
local bugConnection = nil
local textBoxCount = 0

-- Criar ScreenGui
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "BugPlayerGUI"
ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
ScreenGui.ResetOnSpawn = false

-- Frame principal
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
MainFrame.BorderSizePixel = 0
MainFrame.Position = UDim2.new(0.1, 0, 0.1, 0)
MainFrame.Size = UDim2.new(0, 350, 0, 500)
MainFrame.Active = true
MainFrame.Draggable = true

-- Adicionar corner ao frame principal
local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 12)
MainCorner.Parent = MainFrame

-- Header
local Header = Instance.new("Frame")
Header.Name = "Header"
Header.Parent = MainFrame
Header.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
Header.BorderSizePixel = 0
Header.Size = UDim2.new(1, 0, 0, 50)

local HeaderCorner = Instance.new("UICorner")
HeaderCorner.CornerRadius = UDim.new(0, 12)
HeaderCorner.Parent = Header

-- T√≠tulo
local Title = Instance.new("TextLabel")
Title.Name = "Title"
Title.Parent = Header
Title.BackgroundTransparency = 1
Title.Position = UDim2.new(0, 15, 0, 0)
Title.Size = UDim2.new(1, -60, 1, 0)
Title.Font = Enum.Font.GothamBold
Title.Text = "üêõ Bug Player System"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextScaled = true
Title.TextXAlignment = Enum.TextXAlignment.Left

-- Bot√£o fechar
local CloseButton = Instance.new("TextButton")
CloseButton.Name = "CloseButton"
CloseButton.Parent = Header
CloseButton.BackgroundColor3 = Color3.fromRGB(255, 85, 85)
CloseButton.BorderSizePixel = 0
CloseButton.Position = UDim2.new(1, -40, 0, 10)
CloseButton.Size = UDim2.new(0, 30, 0, 30)
CloseButton.Font = Enum.Font.GothamBold
CloseButton.Text = "√ó"
CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.TextScaled = true

local CloseCorner = Instance.new("UICorner")
CloseCorner.CornerRadius = UDim.new(0, 8)
CloseCorner.Parent = CloseButton

-- Status Frame
local StatusFrame = Instance.new("Frame")
StatusFrame.Name = "StatusFrame"
StatusFrame.Parent = MainFrame
StatusFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
StatusFrame.BorderSizePixel = 0
StatusFrame.Position = UDim2.new(0, 10, 0, 60)
StatusFrame.Size = UDim2.new(1, -20, 0, 80)

local StatusCorner = Instance.new("UICorner")
StatusCorner.CornerRadius = UDim.new(0, 8)
StatusCorner.Parent = StatusFrame

-- Status Label
local StatusLabel = Instance.new("TextLabel")
StatusLabel.Name = "StatusLabel"
StatusLabel.Parent = StatusFrame
StatusLabel.BackgroundTransparency = 1
StatusLabel.Position = UDim2.new(0, 10, 0, 10)
StatusLabel.Size = UDim2.new(1, -20, 0, 25)
StatusLabel.Font = Enum.Font.Gotham
StatusLabel.Text = "Status: ‚ö´ Bug Inativo"
StatusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
StatusLabel.TextScaled = true
StatusLabel.TextXAlignment = Enum.TextXAlignment.Left

-- Info Label
local InfoLabel = Instance.new("TextLabel")
InfoLabel.Name = "InfoLabel"
InfoLabel.Parent = StatusFrame
InfoLabel.BackgroundTransparency = 1
InfoLabel.Position = UDim2.new(0, 10, 0, 40)
InfoLabel.Size = UDim2.new(1, -20, 0, 25)
InfoLabel.Font = Enum.Font.Gotham
InfoLabel.Text = "üí° Digite nicks parciais ou completos dos players"
InfoLabel.TextColor3 = Color3.fromRGB(150, 150, 150)
InfoLabel.TextScaled = true
InfoLabel.TextXAlignment = Enum.TextXAlignment.Left

-- Bot√£o adicionar TextBox
local AddButton = Instance.new("TextButton")
AddButton.Name = "AddButton"
AddButton.Parent = MainFrame
AddButton.BackgroundColor3 = Color3.fromRGB(85, 255, 85)
AddButton.BorderSizePixel = 0
AddButton.Position = UDim2.new(0, 10, 0, 150)
AddButton.Size = UDim2.new(1, -20, 0, 40)
AddButton.Font = Enum.Font.GothamBold
AddButton.Text = "‚ûï Adicionar Player"
AddButton.TextColor3 = Color3.fromRGB(255, 255, 255)
AddButton.TextScaled = true

local AddCorner = Instance.new("UICorner")
AddCorner.CornerRadius = UDim.new(0, 8)
AddCorner.Parent = AddButton

-- ScrollFrame para TextBoxes
local TextBoxScrollFrame = Instance.new("ScrollingFrame")
TextBoxScrollFrame.Name = "TextBoxScrollFrame"
TextBoxScrollFrame.Parent = MainFrame
TextBoxScrollFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
TextBoxScrollFrame.BorderSizePixel = 0
TextBoxScrollFrame.Position = UDim2.new(0, 10, 0, 200)
TextBoxScrollFrame.Size = UDim2.new(1, -20, 1, -310)
TextBoxScrollFrame.ScrollBarThickness = 6
TextBoxScrollFrame.ScrollBarImageColor3 = Color3.fromRGB(85, 170, 255)
TextBoxScrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)

local ScrollCorner = Instance.new("UICorner")
ScrollCorner.CornerRadius = UDim.new(0, 8)
ScrollCorner.Parent = TextBoxScrollFrame

-- Layout para TextBoxes
local ListLayout = Instance.new("UIListLayout")
ListLayout.Parent = TextBoxScrollFrame
ListLayout.SortOrder = Enum.SortOrder.LayoutOrder
ListLayout.Padding = UDim.new(0, 5)
ListLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center

-- Bot√£o Ativar/Desativar Bug
local BugButton = Instance.new("TextButton")
BugButton.Name = "BugButton"
BugButton.Parent = MainFrame
BugButton.BackgroundColor3 = Color3.fromRGB(85, 255, 85)
BugButton.BorderSizePixel = 0
BugButton.Position = UDim2.new(0, 10, 1, -50)
BugButton.Size = UDim2.new(1, -20, 0, 40)
BugButton.Font = Enum.Font.GothamBold
BugButton.Text = "üü¢ Ativar Bug"
BugButton.TextColor3 = Color3.fromRGB(255, 255, 255)
BugButton.TextScaled = true

local BugCorner = Instance.new("UICorner")
BugCorner.CornerRadius = UDim.new(0, 8)
BugCorner.Parent = BugButton

-- Fun√ß√£o para criar notifica√ß√£o
local function createNotification(title, message, color)
    local NotifGui = Instance.new("ScreenGui")
    NotifGui.Parent = LocalPlayer.PlayerGui
    NotifGui.ResetOnSpawn = false
    
    local NotifFrame = Instance.new("Frame")
    NotifFrame.Parent = NotifGui
    NotifFrame.BackgroundColor3 = color or Color3.fromRGB(40, 40, 40)
    NotifFrame.BorderSizePixel = 0
    NotifFrame.Position = UDim2.new(1, 10, 0, 100)
    NotifFrame.Size = UDim2.new(0, 300, 0, 80)
    
    local NotifCorner = Instance.new("UICorner")
    NotifCorner.CornerRadius = UDim.new(0, 8)
    NotifCorner.Parent = NotifFrame
    
    local NotifTitle = Instance.new("TextLabel")
    NotifTitle.Parent = NotifFrame
    NotifTitle.BackgroundTransparency = 1
    NotifTitle.Position = UDim2.new(0, 10, 0, 5)
    NotifTitle.Size = UDim2.new(1, -20, 0, 25)
    NotifTitle.Font = Enum.Font.GothamBold
    NotifTitle.Text = title
    NotifTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
    NotifTitle.TextScaled = true
    NotifTitle.TextXAlignment = Enum.TextXAlignment.Left
    
    local NotifMessage = Instance.new("TextLabel")
    NotifMessage.Parent = NotifFrame
    NotifMessage.BackgroundTransparency = 1
    NotifMessage.Position = UDim2.new(0, 10, 0, 30)
    NotifMessage.Size = UDim2.new(1, -20, 0, 45)
    NotifMessage.Font = Enum.Font.Gotham
    NotifMessage.Text = message
    NotifMessage.TextColor3 = Color3.fromRGB(200, 200, 200)
    NotifMessage.TextScaled = true
    NotifMessage.TextWrapped = true
    NotifMessage.TextXAlignment = Enum.TextXAlignment.Left
    NotifMessage.TextYAlignment = Enum.TextYAlignment.Top
    
    -- Anima√ß√£o de entrada
    local slideIn = TweenService:Create(NotifFrame, TweenInfo.new(0.5, Enum.EasingStyle.Back), {Position = UDim2.new(1, -310, 0, 100)})
    slideIn:Play()
    
    -- Remover ap√≥s 3 segundos
    game:GetService("Debris"):AddItem(NotifGui, 3)
    wait(2.5)
    local slideOut = TweenService:Create(NotifFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {Position = UDim2.new(1, 10, 0, 100)})
    slideOut:Play()
end

-- Fun√ß√£o para encontrar player por nick parcial
local function findPlayerByPartialName(partialName)
    if partialName == "" then return nil end
    
    partialName = partialName:lower()
    
    -- Primeiro, procura por match exato
    for _, player in pairs(Players:GetPlayers()) do
        if player.Name:lower() == partialName then
            return player
        end
    end
    
    -- Depois, procura por match parcial
    for _, player in pairs(Players:GetPlayers()) do
        if player.Name:lower():find(partialName, 1, true) then
            return player
        end
    end
    
    return nil
end

-- Fun√ß√£o para atualizar canvas size
local function updateCanvasSize()
    local contentHeight = ListLayout.AbsoluteContentSize.Y
    TextBoxScrollFrame.CanvasSize = UDim2.new(0, 0, 0, contentHeight + 10)
end

-- Fun√ß√£o para remover TextBox
local function removeTextBox(textBoxFrame)
    local textBoxId = textBoxFrame.Name:gsub("TextBoxFrame", "")
    textBoxes[tonumber(textBoxId)] = nil
    textBoxFrame:Destroy()
    updateCanvasSize()
    createNotification("üóëÔ∏è Player Removido", "TextBox removida com sucesso!", Color3.fromRGB(255, 170, 85))
end

-- Fun√ß√£o para criar TextBox
local function createTextBox()
    textBoxCount = textBoxCount + 1
    local textBoxId = textBoxCount
    
    local TextBoxFrame = Instance.new("Frame")
    TextBoxFrame.Name = "TextBoxFrame" .. textBoxId
    TextBoxFrame.Parent = TextBoxScrollFrame
    TextBoxFrame.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
    TextBoxFrame.BorderSizePixel = 0
    TextBoxFrame.Size = UDim2.new(1, -10, 0, 40)
    TextBoxFrame.LayoutOrder = textBoxId
    
    local TextBoxCorner = Instance.new("UICorner")
    TextBoxCorner.CornerRadius = UDim.new(0, 6)
    TextBoxCorner.Parent = TextBoxFrame
    
    -- TextBox para nick
    local PlayerTextBox = Instance.new("TextBox")
    PlayerTextBox.Name = "PlayerTextBox"
    PlayerTextBox.Parent = TextBoxFrame
    PlayerTextBox.BackgroundTransparency = 1
    PlayerTextBox.Position = UDim2.new(0, 10, 0, 0)
    PlayerTextBox.Size = UDim2.new(1, -50, 1, 0)
    PlayerTextBox.Font = Enum.Font.Gotham
    PlayerTextBox.PlaceholderText = "Digite o nick do player..."
    PlayerTextBox.Text = ""
    PlayerTextBox.TextColor3 = Color3.fromRGB(255, 255, 255)
    PlayerTextBox.TextScaled = true
    PlayerTextBox.TextXAlignment = Enum.TextXAlignment.Left
    
    -- Bot√£o remover
    local RemoveButton = Instance.new("TextButton")
    RemoveButton.Name = "RemoveButton"
    RemoveButton.Parent = TextBoxFrame
    RemoveButton.BackgroundColor3 = Color3.fromRGB(255, 85, 85)
    RemoveButton.BorderSizePixel = 0
    RemoveButton.Position = UDim2.new(1, -35, 0, 5)
    RemoveButton.Size = UDim2.new(0, 30, 0, 30)
    RemoveButton.Font = Enum.Font.GothamBold
    RemoveButton.Text = "‚ûñ"
    RemoveButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    RemoveButton.TextScaled = true
    
    local RemoveCorner = Instance.new("UICorner")
    RemoveCorner.CornerRadius = UDim.new(0, 4)
    RemoveCorner.Parent = RemoveButton
    
    -- Conectar evento de remo√ß√£o
    RemoveButton.MouseButton1Click:Connect(function()
        removeTextBox(TextBoxFrame)
    end)
    
    -- Efeito visual para mudan√ßa de cor baseada na validade do nick
    PlayerTextBox.Changed:Connect(function()
        local player = findPlayerByPartialName(PlayerTextBox.Text)
        if PlayerTextBox.Text == "" then
            TextBoxFrame.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
        elseif player then
            TextBoxFrame.BackgroundColor3 = Color3.fromRGB(85, 255, 85)
            PlayerTextBox.PlaceholderText = "‚úÖ Player encontrado: " .. player.Name
        else
            TextBoxFrame.BackgroundColor3 = Color3.fromRGB(255, 85, 85)
            PlayerTextBox.PlaceholderText = "‚ùå Player n√£o encontrado"
        end
    end)
    
    textBoxes[textBoxId] = {
        frame = TextBoxFrame,
        textBox = PlayerTextBox
    }
    
    updateCanvasSize()
    createNotification("‚ûï TextBox Adicionada", "Nova textbox criada! Digite o nick do player.", Color3.fromRGB(85, 255, 85))
end

-- Fun√ß√£o para obter players v√°lidos das TextBoxes
local function getValidPlayers()
    local validPlayers = {}
    
    for _, textBoxData in pairs(textBoxes) do
        if textBoxData and textBoxData.textBox then
            local player = findPlayerByPartialName(textBoxData.textBox.Text)
            if player and player ~= LocalPlayer then
                table.insert(validPlayers, player)
            end
        end
    end
    
    return validPlayers
end

-- Fun√ß√£o para alternar bug player
local function toggleBugPlayer()
    if bugPlayerActive then
        -- Desativar bug
        if bugConnection then
            bugConnection:Disconnect()
            bugConnection = nil
        end
        bugPlayerActive = false
        StatusLabel.Text = "Status: ‚ö´ Bug Inativo"
        BugButton.Text = "üü¢ Ativar Bug"
        BugButton.BackgroundColor3 = Color3.fromRGB(85, 255, 85)
        createNotification("üêõ Bug Desativado", "O bug foi desativado para todos os players.", Color3.fromRGB(255, 85, 85))
    else
        local validPlayers = getValidPlayers()
        
        if #validPlayers == 0 then
            createNotification("‚ùå Erro", "Nenhum player v√°lido encontrado nas textboxes.", Color3.fromRGB(255, 85, 85))
            return
        end
        
        bugPlayerActive = true
        StatusLabel.Text = "Status: üî¥ Bug Ativo"
        BugButton.Text = "üî¥ Desativar Bug"
        BugButton.BackgroundColor3 = Color3.fromRGB(255, 85, 85)
        
        local Remote = ReplicatedStorage.RE:FindFirstChild("1Gu1n")
        
        if not Remote then
            createNotification("‚ùå Erro", "Remote n√£o encontrado. Certifique-se de estar no jogo correto.", Color3.fromRGB(255, 85, 85))
            bugPlayerActive = false
            StatusLabel.Text = "Status: ‚ö´ Bug Inativo"
            BugButton.Text = "üü¢ Ativar Bug"
            BugButton.BackgroundColor3 = Color3.fromRGB(85, 255, 85)
            return
        end
        
        local index = 1
        bugConnection = RunService.Stepped:Connect(function()
            if not bugPlayerActive then return end
            
            local currentValidPlayers = getValidPlayers()
            if #currentValidPlayers < 1 then return end
            
            index = index + 1
            if index > #currentValidPlayers then index = 1 end
            local target = currentValidPlayers[index]
            
            if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
                local crazyVector = Vector3.new(
                    math.random(1e14, 1e15),
                    math.random(1e14, 1e15),
                    math.random(1e14, 1e15)
                )
                local args = {
                    [1] = target.Character.HumanoidRootPart,
                    [2] = target.Character.HumanoidRootPart,
                    [3] = crazyVector,
                    [4] = target.Character.HumanoidRootPart.Position,
                    [5] = LocalPlayer.Backpack:FindFirstChild("Assault") and LocalPlayer.Backpack.Assault.GunScript_Local:FindFirstChild("MuzzleEffect"),
                    [6] = LocalPlayer.Backpack:FindFirstChild("Assault") and LocalPlayer.Backpack.Assault.GunScript_Local:FindFirstChild("HitEffect"),
                    [7] = 0,
                    [8] = 0,
                    [9] = { [1] = false },
                    [10] = {
                        [1] = 25,
                        [2] = Vector3.new(100, 100, 100),
                        [3] = BrickColor.new(29),
                        [4] = 0.25,
                        [5] = Enum.Material.SmoothPlastic,
                        [6] = 0.25
                    },
                    [11] = true,
                    [12] = false
                }
                Remote:FireServer(unpack(args))
            end
        end)
        
        createNotification("üêõ Bug Ativado", "Bug ativado para " .. #validPlayers .. " player(s) v√°lido(s).", Color3.fromRGB(85, 255, 85))
    end
end

-- Conectar eventos
AddButton.MouseButton1Click:Connect(createTextBox)
BugButton.MouseButton1Click:Connect(toggleBugPlayer)

CloseButton.MouseButton1Click:Connect(function()
    -- Desativar bug se estiver ativo
    if bugPlayerActive then
        toggleBugPlayer()
    end
    ScreenGui:Destroy()
end)

-- Efeitos visuais para bot√µes
local function addButtonEffects(button)
    button.MouseEnter:Connect(function()
        local tween = TweenService:Create(button, TweenInfo.new(0.2), {Size = button.Size + UDim2.new(0, 5, 0, 2)})
        tween:Play()
    end)
    
    button.MouseLeave:Connect(function()
        local tween = TweenService:Create(button, TweenInfo.new(0.2), {Size = button.Size - UDim2.new(0, 5, 0, 2)})
        tween:Play()
    end)
end

addButtonEffects(AddButton)
addButtonEffects(BugButton)
addButtonEffects(CloseButton)

-- Atualizar layout quando conte√∫do mudar
ListLayout.Changed:Connect(function()
    updateCanvasSize()
end)

-- Anima√ß√£o de entrada da GUI
MainFrame.Position = UDim2.new(0.1, 0, -1, 0)
local slideIn = TweenService:Create(MainFrame, TweenInfo.new(0.7, Enum.EasingStyle.Back), {Position = UDim2.new(0.1, 0, 0.1, 0)})
slideIn:Play()

-- Inicializar com uma TextBox
createTextBox()
createNotification("üêõ Bug Player GUI", "Sistema carregado! Use ‚ûï para adicionar players e ‚ûñ para remover.", Color3.fromRGB(85, 170, 255))
