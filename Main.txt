-- Bug Player GUI Compacto
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

local selectedPlayers = {}
local bugActive = false
local bugConnection

-- Criar GUI compacto
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
ScreenGui.ResetOnSpawn = false

local MainFrame = Instance.new("Frame")
MainFrame.Parent = ScreenGui
MainFrame.Size = UDim2.new(0, 200, 0, 330) -- aumentei um pouco pra caber bot√£o de atualizar
MainFrame.Position = UDim2.new(0.05, 0, 0.05, 0)
MainFrame.BackgroundColor3 = Color3.fromRGB(25,25,25)
MainFrame.Active = true
MainFrame.Draggable = true

local Title = Instance.new("TextLabel")
Title.Parent = MainFrame
Title.Size = UDim2.new(1,0,0,30)
Title.Text = "üêõ Bug Player"
Title.BackgroundTransparency = 1
Title.TextScaled = true
Title.TextColor3 = Color3.fromRGB(255,255,255)

local Scroll = Instance.new("ScrollingFrame")
Scroll.Parent = MainFrame
Scroll.Size = UDim2.new(1, -10, 1, -100)
Scroll.Position = UDim2.new(0,5,0,35)
Scroll.BackgroundColor3 = Color3.fromRGB(40,40,40)
Scroll.ScrollBarThickness = 5
Scroll.CanvasSize = UDim2.new(0,0,0,0)

local UIList = Instance.new("UIListLayout")
UIList.Parent = Scroll
UIList.Padding = UDim.new(0,3)
UIList.SortOrder = Enum.SortOrder.LayoutOrder

-- Fun√ß√£o para atualizar altura do scroll automaticamente
local function updateCanvas()
    local contentSize = UIList.AbsoluteContentSize.Y
    Scroll.CanvasSize = UDim2.new(0,0,0,contentSize + 5)
end
UIList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(updateCanvas)
updateCanvas()

-- Criar bot√£o para cada player
local function createPlayerButton(player)
    local btn = Instance.new("TextButton")
    btn.Parent = Scroll
    btn.Size = UDim2.new(1,0,0,25)
    btn.Text = player.Name
    btn.BackgroundColor3 = Color3.fromRGB(80,80,80)
    btn.TextColor3 = Color3.fromRGB(255,255,255)
    btn.TextScaled = true

    btn.MouseButton1Click:Connect(function()
        if selectedPlayers[player.Name] then
            selectedPlayers[player.Name] = nil
            btn.BackgroundColor3 = Color3.fromRGB(80,80,80)
        else
            selectedPlayers[player.Name] = true
            btn.BackgroundColor3 = Color3.fromRGB(0, 255, 255)
        end
    end)

    updateCanvas()
end

-- Fun√ß√£o para atualizar lista
local function refreshPlayerList()
    -- Limpar antigos
    for _, child in pairs(Scroll:GetChildren()) do
        if child:IsA("TextButton") then
            child:Destroy()
        end
    end
    -- Criar bot√£o para todos players
    for _, p in pairs(Players:GetPlayers()) do
        if p ~= LocalPlayer then
            createPlayerButton(p)
        end
    end
end

-- Criar bot√£o de atualizar
local RefreshButton = Instance.new("TextButton")
RefreshButton.Parent = MainFrame
RefreshButton.Size = UDim2.new(1, -10, 0, 30)
RefreshButton.Position = UDim2.new(0,5,0,220)
RefreshButton.Text = "üîÑ Atualizar Lista"
RefreshButton.BackgroundColor3 = Color3.fromRGB(0,170,255)
RefreshButton.TextColor3 = Color3.fromRGB(0,0,0)
RefreshButton.TextScaled = true

RefreshButton.MouseButton1Click:Connect(function()
    refreshPlayerList()
end)

-- Inicializa lista
refreshPlayerList()

-- Adicionar player automaticamente quando entrar
Players.PlayerAdded:Connect(function(p)
    if p ~= LocalPlayer then
        createPlayerButton(p)
    end
end)

-- Bot√£o de ativar/desativar bug
local BugButton = Instance.new("TextButton")
BugButton.Parent = MainFrame
BugButton.Size = UDim2.new(1, -10, 0, 30)
BugButton.Position = UDim2.new(0,5,0,260)
BugButton.Text = "üü¢ Ativar Bug"
BugButton.BackgroundColor3 = Color3.fromRGB(0,255,0)
BugButton.TextColor3 = Color3.fromRGB(0,0,0)
BugButton.TextScaled = true

-- Fun√ß√£o bug
local function startBug()
    local Remote = ReplicatedStorage:WaitForChild("RE"):WaitForChild("1Gu1n")
    bugConnection = RunService.Stepped:Connect(function()
        for playerName,_ in pairs(selectedPlayers) do
            local target = Players:FindFirstChild(playerName)
            if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
                local crazyVector = Vector3.new(
                    math.random(-1e7, 1e7),
                    math.random(-1e7, 1e7),
                    math.random(-1e7, 1e7)
                )
                local args = {
                    [1] = target.Character.HumanoidRootPart,
                    [2] = target.Character.HumanoidRootPart,
                    [3] = crazyVector,
                    [4] = target.Character.HumanoidRootPart.Position,
                    [5] = LocalPlayer.Backpack:FindFirstChild("Assault") and LocalPlayer.Backpack.Assault.GunScript_Local:FindFirstChild("MuzzleEffect"),
                    [6] = LocalPlayer.Backpack:FindFirstChild("Assault") and LocalPlayer.Backpack.Assault.GunScript_Local:FindFirstChild("HitEffect"),
                    [7] = 10000,
                    [8] = 10000,
                    [9] = { [1] = false },
                    [10] = {
                        [1] = 10000,
                        [2] = Vector3.new(3000, 3000, 3000),
                        [3] = BrickColor.new(29),
                        [4] = 0.05,
                        [5] = Enum.Material.SmoothPlastic,
                        [6] = 0.05
                    },
                    [11] = true,
                    [12] = false
                }
                Remote:FireServer(unpack(args))
            end
        end
    end)
end

-- Ativar/desativar bug
BugButton.MouseButton1Click:Connect(function()
    if bugActive then
        bugActive = false
        BugButton.Text = "üü¢ Ativar Bug"
        BugButton.BackgroundColor3 = Color3.fromRGB(0,255,0)
        if bugConnection then
            bugConnection:Disconnect()
            bugConnection = nil
        end
    else
        if next(selectedPlayers) == nil then return end
        bugActive = true
        BugButton.Text = "üî¥ Desativar Bug"
        BugButton.BackgroundColor3 = Color3.fromRGB(255,0,0)
        startBug()
    end
end)
